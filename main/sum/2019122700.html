<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>OT fechel duality 快速计算框架</title>
</head>
<body>
<article>前面说了很多理论的东西，我们现在就看看如何快速进行 OT 的 fenchel duality 的计算.

## primal --> dual

对于连续的case，默认 $\pi$ 的无约束空间是 $M(X\times Y)$, $\varphi$ 的无约束空间是 $C_b(X)$, $\psi$ 的无约束空间是 $C_b(Y)$.

首先，我们现在有一个 ROT(regularized OT) 框架：

$ \text{OT}_{\Omega} (\mu, \nu) = \inf\limits_{\pi\in \Pi(\mu,\nu)} [ \int cd\pi + \Omega(\pi) ]  $

那么可以直接写出 dual ROT:

$ \text{OT}_{\Omega} (\mu, \nu) = \sup\limits_{\varphi,\psi} \int \varphi d\mu + \int \psi d\nu - \Omega^*(\varphi \oplus \psi - c) $

其中 $\Omega^*$ 是 $\Omega$ 的凸共轭. $\oplus$ 是直和.


## 方便理论推导的快速计算框架

1, biconjugate 法. 
primal ROT(regularized OT) 可以看作是 $a, b$ 的函数，即 $ \text{OT}_{\Omega}(a, b) $.
如果把 $ \text{OT}_{\Omega}(a, b) $ 写成 $ \text{OT}_{\Omega}(a\oplus b) $, 那么容易证明 $ \text{OT}^*_{\Omega}(a\oplus b) $ 恰巧就是 dual ROT 的约束
如果把 $ \text{OT}_{\Omega}(a, b) $ 写成 $ \text{OT}_{b,\Omega}(a) $, $b$ 是固定值. 那么容易证明 $ \text{OT}^*_{b,\Omega}(a) $ 是 semi-dual ROT 的约束

一个函数，conjugate 一次，能够获得约束，conjugate 两次就获得了 dual form.

2, primal --> dual 的口诀：优化目标的凸共轭是约束，约束的凸共轭是优化目标. inf 中约束是加号，sup 中约束是减号.
$ \text{OT}_{\Omega} (\mu, \nu) = \inf\limits_{\pi\in \Pi(\mu,\nu)} [ \int cd\pi + \Omega(\pi) ]  $
那么，$ \int cd\pi + \Omega(\pi) $ 的凸共轭是 dual ROT 的约束.
$ \pi\in \Pi(\mu,\nu) $ 的凸共轭是 dual ROT 的优化目标.

一般我们计算凸共轭的时候，都**要求 primal variable 是无约束的**，就算是有约束的，也可以通过引入指示函数变成无约束的.</article>
</body>
<script src="https://static.outiy5.com/js/adv_dev.js?css=table1,basic;js=toc,mathjax;mod=md"></script>
</html>